
CS 3513, Homework 8
Example Solution

Using scipy.integrate.romberg to calculate integral values
Note: Integral 0 is not part of the assignment.
Integral 0 : int_0^pi sin(x) dx : =  2.000000000000 using scipy
Integral 1 : int_0^1  1/(1+x^2)  dx :  =  0.785398163397 using scipy
Integral 2 : int_0^4  x * sqrt(x^2 + 9) dx :  = 32.666666666667 using scipy
Problem 1: solving integrals using Monte Carlo methods
   Integral 0 : int_0^pi sin(x) dx :
       = 1.98501529353949 using     100 samples.  Relative error = 7.492e-03
       = 2.02444743117194 using   10000 samples.  Relative error = 1.222e-02
       = 2.00101900666377 using 1000000 samples.  Relative error = 5.095e-04
   Integral 1 : int_0^1  1/(1+x^2)  dx : 
       = 0.78456916155448 using     100 samples.  Relative error = 1.056e-03
       = 0.78210818114428 using   10000 samples.  Relative error = 4.189e-03
       = 0.78545418659282 using 1000000 samples.  Relative error = 7.133e-05
   Integral 2 : int_0^4  x * sqrt(x^2 + 9) dx : 
       = 30.94162395010444 using     100 samples.  Relative error = 5.281e-02
       = 32.66043836927343 using   10000 samples.  Relative error = 1.907e-04
       = 32.64556450658569 using 1000000 samples.  Relative error = 6.460e-04

Problem 2: Numerical verification of rate of convergence for trapezoidal integration
   Integral 0 : int_0^pi sin(x) dx :
         n        h          T_h(f)          e_h     e_2h/e_h
         1 3.141593 0.0000000000000  2.00000e+00
         2 1.570796 1.5707963267949  4.29204e-01  4.65979e+00
         4 0.785398 1.8961188979370  1.03881e-01  4.13168e+00
         8 0.392699 1.9742316019456  2.57684e-02  4.03134e+00
        16 0.196350 1.9935703437723  6.42966e-03  4.00774e+00
        32 0.098175 1.9983933609701  1.60664e-03  4.00193e+00
        64 0.049087 1.9995983886400  4.01611e-04  4.00048e+00
       128 0.024544 1.9998996001842  1.00400e-04  4.00012e+00
   Integral 1 : int_0^1  1/(1+x^2)  dx : 
         n        h          T_h(f)          e_h     e_2h/e_h
         1 1.000000 0.7500000000000  3.53982e-02
         2 0.500000 0.7750000000000  1.03982e-02  3.40427e+00
         4 0.250000 0.7827941176471  2.60405e-03  3.99308e+00
         8 0.125000 0.7847471236228  6.51040e-04  3.99983e+00
        16 0.062500 0.7852354030103  1.62760e-04  3.99999e+00
        32 0.031250 0.7853574732937  4.06901e-05  4.00000e+00
        64 0.015625 0.7853879908714  1.01725e-05  4.00000e+00
       128 0.007812 0.7853956202659  2.54313e-06  4.00000e+00
   Integral 2 : int_0^4  x * sqrt(x^2 + 9) dx : 
         n        h          T_h(f)          e_h     e_2h/e_h
         1 4.000000 40.0000000000000  7.33333e+00
         2 2.000000 34.4222051018560  1.75554e+00  4.17726e+00
         4 1.000000 33.1013022724542  4.34636e-01  4.03910e+00
         8 0.500000 32.7750803747746  1.08414e-01  4.00905e+00
        16 0.250000 32.6937550084104  2.70883e-02  4.00223e+00
        32 0.125000 32.6734378127940  6.77115e-03  4.00055e+00
        64 0.062500 32.6683593945460  1.69273e-03  4.00014e+00
       128 0.031250 32.6670898449716  4.23178e-04  4.00003e+00

Problem 3: Romberg
   Integral 0 : int_0^pi sin(x) dx :
   Value = 1.9999999999999987, Converge flag = True , Table R = 
[[  1.9236706937218e-16   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00]
 [  1.5707963267949e+00   2.0943951023932e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00]
 [  1.8961188979370e+00   2.0045597549844e+00   1.9985707318238e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00]
 [  1.9742316019456e+00   2.0002691699484e+00   1.9999831309460e+00   2.0000055499797e+00   0.0000000000000e+00   0.0000000000000e+00   0.0000000000000e+00]
 [  1.9935703437723e+00   2.0000165910479e+00   1.9999997524546e+00   2.0000000162880e+00   1.9999999945873e+00   0.0000000000000e+00   0.0000000000000e+00]
 [  1.9983933609701e+00   2.0000010333694e+00   1.9999999961908e+00   2.0000000000597e+00   1.9999999999960e+00   2.0000000000013e+00   0.0000000000000e+00]
 [  1.9995983886400e+00   2.0000000645300e+00   1.9999999999407e+00   2.0000000000002e+00   2.0000000000000e+00   2.0000000000000e+00   2.0000000000000e+00]]
   Error ratios = 
[[  4.6598e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.1317e+00   2.0702e+01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0313e+00   1.6940e+01   8.4727e+01   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0077e+00   1.6224e+01   6.8145e+01   3.4074e+02   0.0000e+00   0.0000e+00]
 [  4.0019e+00   1.6055e+01   6.4987e+01   2.7294e+02   1.3652e+03   0.0000e+00]
 [  4.0005e+00   1.6014e+01   6.4244e+01   2.5992e+02   1.1160e+03   5.9540e+03]]
   Integral 1 : int_0^1  1/(1+x^2)  dx : 
   Value = 0.7853981633974483, Converge flag = True , Table R = 
[[ 0.75             0.               0.               0.               0.               0.               0.               0.             ]
 [ 0.775            0.7833333333333  0.               0.               0.               0.               0.               0.             ]
 [ 0.7827941176471  0.7853921568627  0.7855294117647  0.               0.               0.               0.               0.             ]
 [ 0.7847471236228  0.7853981256147  0.7853985235315  0.7853964459405  0.               0.               0.               0.             ]
 [ 0.7852354030103  0.7853981628062  0.7853981652856  0.7853981595992  0.7853981663194  0.               0.               0.             ]
 [ 0.7853574732937  0.7853981633882  0.785398163427   0.7853981633975  0.7853981634124  0.7853981634096  0.               0.             ]
 [ 0.7853879908714  0.7853981633973  0.7853981633979  0.7853981633974  0.7853981633974  0.7853981633974  0.7853981633974  0.             ]
 [ 0.7853956202659  0.7853981633974  0.7853981633975  0.7853981633974  0.7853981633974  0.7853981633974  0.7853981633974  0.7853981633974]]
   Error ratios = 
[[  3.4043e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  3.9931e+00   3.4376e+02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  3.9998e+00   1.5898e+02   3.6444e+02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0000e+00   6.3904e+01   1.9073e+02   4.5217e+02   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0000e+00   6.3993e+01   6.3874e+01   6.4307e+04   1.9539e+02   0.0000e+00   0.0000e+00]
 [  4.0000e+00   6.4064e+01   6.3959e+01   2.6600e+02          inf   8.2653e+02   0.0000e+00]
 [  4.0000e+00   6.1857e+01   6.4046e+01          inf          inf          inf          inf]]
   Integral 2 : int_0^4  x * sqrt(x^2 + 9) dx : 
   Value = 32.666666666666664, Converge flag = True , Table R = 
[[ 40.                0.                0.                0.                0.                0.                0.                0.             ]
 [ 34.422205101856   32.5629401358079   0.                0.                0.                0.                0.                0.             ]
 [ 33.1013022724542  32.6610013293203  32.6675387422211   0.                0.                0.                0.                0.             ]
 [ 32.7750803747746  32.6663397422147  32.6666956364077  32.6666822537757   0.                0.                0.                0.             ]
 [ 32.6937550084104  32.6666465529557  32.6666670070051  32.6666665525701  32.6666664909967   0.                0.                0.             ]
 [ 32.673437812794   32.6666654142552  32.6666666716751  32.6666666663524  32.6666666667986  32.6666666669705   0.                0.             ]
 [ 32.668359394546   32.6666665884634  32.6666666667439  32.6666666666656  32.6666666666669  32.6666666666667  32.6666666666667   0.             ]
 [ 32.6670898449716  32.6666666617801  32.6666666666679  32.6666666666667  32.6666666666667  32.6666666666667  32.6666666666667  32.6666666666667]]
   Error ratios = 
[[  4.1773e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0391e+00   1.8309e+01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0090e+00   1.7329e+01   3.0103e+01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0022e+00   1.6254e+01   8.5120e+01   1.3661e+02   0.0000e+00   0.0000e+00   0.0000e+00]
 [  4.0006e+00   1.6060e+01   6.7953e+01   3.6311e+02   1.3310e+03   0.0000e+00   0.0000e+00]
 [  4.0001e+00   1.6015e+01   6.4840e+01   3.0499e+02   6.8796e+02   4.7512e+03   0.0000e+00]
 [  4.0000e+00   1.6004e+01   6.3947e+01          inf          inf          inf          inf]]

